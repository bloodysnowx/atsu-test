--- ツール名 ---

PTRtoNote

--- ファイル説明 ---

PTRtoNote.exe : 本ツールの本体です。
PTRtoNote.exe.config : 

--- 動作概要 ---

notes.xmlを読み込み、PTRからのデータを追加し、条件によるラベリングを実行し、
データを追加したnotes.xmlを出力します。

--- 全体フロー ---

. ラベル設定ルールをapp.configから読み取る
. PTRのアカウント情報をapp.configから読み取る
. XML(更新版)を生成
. notes.xml(オリジナル)を読み込む
. XML要素を解析
. ラベル要素をオリジナルから更新版にコピー
. プレイヤー毎にループ
  . noteの内容(オリジナル)を読み込む
  . 形式に合致していた場合
	. 日付を確認(古いならばPTRから再取得)
	. ラベル設定ルールに沿って、ラベルを更新
  . 形式に合致していなかった場合
    . PTRから取得
	. 以前のnoteの内容を付加
	. ラベル設定ルールに沿って、ラベルを付加
  . 生成結果を更新版に書き込み
. 更新版を出力する

--- 個別関数 ---

. ラベル要素を取得する関数
. データとラベル設定ルールからラベルを決定する関数
. csvからプレイヤー名を読み込む関数
. 読み込んだプレイヤー名がXMLに存在するか確認し、存在しないならば検索フラグを立てて追加する関数

--- クラス ---

. PTRとの接続クラス
  . PTRにログインする関数 -> done
  . PTRからログアウトする関数 -> 不要？
  . PTRの残り検索回数を確認する関数
  . PTRからデータを取得する関数 -> done
  . PTRのページからデータを切り出す関数
. 個別noteに関するクラス
  . note文字列から内容を切り出す関数
  . データが古いかどうかを判定する関数

--- note文字列 ---

a : 内容を削除し、PTRからデータを取得する
error : エラー時に付与される。再実行時にはerror文字列を削除し、PTRからデータを取得する

string summary = "R:" + dr.GetInt32(2).ToString() + ", H:" + dr.GetInt32(3).ToString()
               + ", $:" + dr.GetDouble(5).ToString("f0") + ", BB:" + dr.GetDouble(4).ToString("f2")
               + ", " + dr.GetDateTime(1).ToString("yyyy/MM/dd");

--- ラベル設定ルール ---

--- 注意 ---

Windows XP Professional SP3 + IE8 + .net Framework 4.0の環境でしかテストしていません。他の環境では
動作しないかもしれません。仮に動作しなかった場合、あまり積極的に対処するつもりはありませんので、VMで
XP環境を構築するなどの自助努力をお願いします。
不具合や要望は連絡してくれたら対処するかもしれません。しかし、必要であればソースコードを提供しますので、
自分で修正してパッチをこちらまで送付してください。GPLは面倒なので採用しませんが、精神としてはGPLのように
お願いします(つまり、他人に頼らずにできることは自分でやろうってことですねー)。自分では無理だけど、
どうしてもっていう場合は気持ち(単位は$)次第ですねｗｗｗｗｗｗｗｗｗ

--- 変更履歴 ---



--- to do ---



--- author ---

bloodysnow

--- date ---



--- version ---
